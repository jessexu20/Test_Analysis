<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Test analysis by jessexu20</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Test analysis</h1>
          <h2>Test and Analysis with JsHint</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/jessexu20/Test_Analysis/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/jessexu20/Test_Analysis/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/jessexu20/Test_Analysis" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h1>
<a id="test_analysis" class="anchor" href="#test_analysis" aria-hidden="true"><span class="octicon octicon-link"></span></a>Test_Analysis</h1>

<h2>
<a id="author" class="anchor" href="#author" aria-hidden="true"><span class="octicon octicon-link"></span></a>Author</h2>

<p>Shiqian Xu,Feifei Wang</p>

<h2>
<a id="test" class="anchor" href="#test" aria-hidden="true"><span class="octicon octicon-link"></span></a>Test</h2>

<h3>
<a id="unit-test--coverage-report" class="anchor" href="#unit-test--coverage-report" aria-hidden="true"><span class="octicon octicon-link"></span></a>Unit Test &amp; Coverage Report</h3>

<p>We are using the Homework 2(Test Generation) as our test sample, subject.js. Therefore we are using Istanbul as our tool to monitor the test coverage.
We saved it into a test.txt file for the script to check the coverage in Analysis Section.</p>

<pre><code>node_modules/.bin/istanbul cover test.js
</code></pre>

<p>The following are the results of Istanbul. </p>

<pre><code>=============================== Coverage summary ===============================
Statements   : 100% ( 14/14 )
Branches     : 100% ( 4/4 )
Functions    : 100% ( 1/1 )
Lines        : 100% ( 13/13 )
================================================================================
</code></pre>

<h3>
<a id="improve-testing-coverage-using-constraint-based-test-generation" class="anchor" href="#improve-testing-coverage-using-constraint-based-test-generation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Improve testing coverage using constraint-based test generation</h3>

<p>We have used the constraint-based test generation method to automatically generate the test cases. The automatically generated test cases are stored in test.js file.
The generated test cases will make the coverage to 100%. In order to automatically generate the test case. You can run the following command.</p>

<pre><code>node main.js
</code></pre>

<p>However, if we change the code in subject.js without running this command. We can get the newly edited code's coverage simply by running the following command to check whether the new code passed all the test cases.</p>

<pre><code>node_modules/.bin/istanbul cover test.js
</code></pre>

<h2>
<a id="analysis" class="anchor" href="#analysis" aria-hidden="true"><span class="octicon octicon-link"></span></a>Analysis</h2>

<h3>
<a id="run-the-static-analysis-tool-jshint-on-the-source-code" class="anchor" href="#run-the-static-analysis-tool-jshint-on-the-source-code" aria-hidden="true"><span class="octicon octicon-link"></span></a>Run the static analysis tool JsHint on the source code</h3>

<p>We have used the static code analysis tool JsHint to run the analyse the subject.js. The info about JsHint can be found <a href="http://jshint.com/docs/">here</a>.
You can install it by the following command.</p>

<pre><code>npm install jshint -g
</code></pre>

<p>You can running the JsHint by the following command.</p>

<pre><code>jshint subject.js
</code></pre>

<p>The following are the errors found by JsHint. We have saved the result into a analysis.txt for scripts using.</p>

<pre><code>subject.js: line 3, col 9, Use '===' to compare with 'null'.
subject.js: line 3, col 21, Missing semicolon.
subject.js: line 6, col 14, Missing semicolon.
subject.js: line 8, col 18, Missing semicolon.
4 errors
</code></pre>

<h4>
<a id="configure-the-options-of-jshint" class="anchor" href="#configure-the-options-of-jshint" aria-hidden="true"><span class="octicon octicon-link"></span></a>Configure the options of JsHint</h4>

<p>We can see that there are 4 erros which are found by JsHint. We can modify the <a href="http://jshint.com/docs/options/">options</a> of the JsHint to omit certain errors found by JsHint.
For example, we want to omit the first error which is using '==' to compare with 'null'.
We can create a .jshintrc file and put the JsHint options into it. The list of the JsHint options can be found here. To omit the above the error,we can put the following into the file.</p>

<pre><code>{
  "eqnull": true,
}
</code></pre>

<p>When we configured the JsHint, we rerun the JsHint, we can get the following the result, which is exactly what we want.</p>

<pre><code>subject.js: line 3, col 21, Missing semicolon.
subject.js: line 6, col 14, Missing semicolon.
subject.js: line 8, col 18, Missing semicolon.
3 errors
</code></pre>

<h3>
<a id="reject-a-commit-if-it-fails-a-minimum-testing-criteria" class="anchor" href="#reject-a-commit-if-it-fails-a-minimum-testing-criteria" aria-hidden="true"><span class="octicon octicon-link"></span></a>Reject a commit if it fails a minimum testing criteria</h3>

<p>We need to configure the Github Hook to reject a commit. We can do it by editing the file in .git/hooks. In this directory, there is a pre-commit.sample file. What we need to do is to rename it into pre-commit and put our logic into it. We have made the pre-commit file to call our own script test.sh file to run when a commit is commited in this git repository. 
In our case, we only put the following into the pre-commit, as we only need it to call test.sh.
    #!/bin/sh
    # Refuse to commit files with if failed coverage test by 50% or failed certain analysis rules#
    echo "call test.sh"
    sh ./test.sh</p>

<h4>
<a id="less-than-50-coverage-of-any-kind-in-coverage-report" class="anchor" href="#less-than-50-coverage-of-any-kind-in-coverage-report" aria-hidden="true"><span class="octicon octicon-link"></span></a>Less than 50% coverage of any kind in Coverage Report</h4>

<p>We have used the Shell Script to get the result from test.txt, as mentioned in Test Section. If there is some coverage which is lower than 50%. We deny that commit and output the error infomation.
The following are the sample result:</p>

<pre><code>Check Commit Script start now
--------Running Istanbul
=============================================================================
Writing coverage object [/Users/jessexu/Documents/North Carolina State University/Courses/CSC591 DevOp/Test_Analysis/coverage/coverage.json]
Writing coverage reports at [/Users/jessexu/Documents/North Carolina State University/Courses/CSC591 DevOp/Test_Analysis/coverage]
=============================================================================
Istanbul Finished

--------Running Static Analysis tool Jshint!!

--------Checking whether Analysis Result Satisfy Requirements~~~~~~

Passed the Analysis Result Satisfy Requirements 
--------Checking whether coverage Satisfy Requirements~~~~~~

Statements Coverage is higher than  50 %! Pass!
Branches Coverage is less than  50 %.
!!!Failed to commit!!! Please check the test.txt for references
</code></pre>

<h4>
<a id="failed-the-analysis-criteria" class="anchor" href="#failed-the-analysis-criteria" aria-hidden="true"><span class="octicon octicon-link"></span></a>Failed the Analysis Criteria</h4>

<p>We have used the Shell Script to get the result from analysis.txt, as mentioned in JsHint Section. If there is certain errors which are found by jshint, we will deny the commit and show the error infomation, in our case is the "missing semicolon". 
The following are the sample result:</p>

<pre><code>Check Commit Script start now
--------Running Istanbul
=============================================================================
Writing coverage object [/Users/jessexu/Documents/North Carolina State University/Courses/CSC591 DevOp/Test_Analysis/coverage/coverage.json]
Writing coverage reports at [/Users/jessexu/Documents/North Carolina State University/Courses/CSC591 DevOp/Test_Analysis/coverage]
=============================================================================
Istanbul Finished

--------Running Static Analysis tool Jshint!!
subject.js: line 3, col 21, Missing semicolon.
subject.js: line 6, col 14, Missing semicolon.
subject.js: line 8, col 18, Missing semicolon.

3 errors

--------Checking whether Analysis Result Satisfy Requirements~~~~~~

!!!Failed to commit!!! There is missing semicolon problems in your program
</code></pre>

<h2>
<a id="result" class="anchor" href="#result" aria-hidden="true"><span class="octicon octicon-link"></span></a>Result</h2>

<p>If you passed all the criteria, you will be able to commit, as the following shows.</p>

<pre><code>Jesses-MacBook-Air:Test_Analysis jessexu$ git add -A
Jesses-MacBook-Air:Test_Analysis jessexu$ git commit -m "test2"
call test.sh
Check Commit Script start now
--------Running Istanbul
=============================================================================
Writing coverage object [/Users/jessexu/Documents/North Carolina State University/Courses/CSC591 DevOp/Test_Analysis/coverage/coverage.json]
Writing coverage reports at [/Users/jessexu/Documents/North Carolina State University/Courses/CSC591 DevOp/Test_Analysis/coverage]
=============================================================================
Istanbul Finished

--------Running Static Analysis tool Jshint!!

--------Checking whether Analysis Result Satisfy Requirements~~~~~~

Passed the Analysis Result Satisfy Requirements 
--------Checking whether coverage Satisfy Requirements~~~~~~

Statements Coverage is higher than  50 %! Pass!
Branches Coverage is higher than  50 %! Pass!
Functions Coverage is higher than  50 %! Pass!
Lines Coverage is higher than  50 %! Pass!

[master 0aacf71] test2
 8 files changed, 87 insertions(+), 40 deletions(-)
 rewrite README.md (63%)
</code></pre>
        </section>

        <footer>
          Test analysis is maintained by <a href="https://github.com/jessexu20">jessexu20</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>